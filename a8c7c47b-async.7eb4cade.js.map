{"version":3,"sources":["docs/react/model-use-openai.zh-CN.md?type=text"],"sourcesContent":["\n  import '/Users/dupeiyi/Project/private/x/packages/x/docs/react/model-use-openai.zh-CN.md?watch=parent';\n  export const texts = [{\"value\":\"这篇指南将介绍如何在使用 Ant Design X 搭建的应用中接入 OpenAI 提供的模型服务，详情请查看\",\"paraId\":0},{\"value\":\"X SDK\",\"paraId\":1},{\"value\":\"。\",\"paraId\":0},{\"value\":\"使用URL接入模型是 X SDK提供的基础能力，详情请查看\",\"paraId\":2,\"tocIndex\":0},{\"value\":\"X SDK\",\"paraId\":3,\"tocIndex\":0},{\"value\":\"。\",\"paraId\":2,\"tocIndex\":0},{\"value\":\"通常情况 openai-node 用于 node 环境，如果在浏览器环境使用，需要开启 \",\"paraId\":4,\"tocIndex\":3},{\"value\":\"dangerouslyAllowBrowser\",\"paraId\":4,\"tocIndex\":3},{\"value\":\"。\",\"paraId\":4,\"tocIndex\":3},{\"value\":\"注意: \",\"paraId\":5,\"tocIndex\":3},{\"value\":\"dangerouslyAllowBrowser\",\"paraId\":5,\"tocIndex\":3},{\"value\":\" 存在安全风险，对此 openai-node 的官方文档有详细的\",\"paraId\":5,\"tocIndex\":3},{\"value\":\"说明\",\"paraId\":5,\"tocIndex\":3},{\"value\":\"。\",\"paraId\":5,\"tocIndex\":3},{\"value\":\"import { Bubble, BubbleListProps, Sender } from '@ant-design/x';\\nimport {\\n  AbstractXRequestClass,\\n  OpenAIChatProvider,\\n  SSEFields,\\n  useXChat,\\n  XModelMessage,\\n  XModelParams,\\n  XRequestOptions,\\n} from '@ant-design/x-sdk';\\nimport { Flex } from 'antd';\\nimport OpenAI from 'openai';\\nimport React, { useState } from 'react';\\n\\ntype OutputType = Partial<Record<SSEFields, any>>;\\ntype InputType = XModelParams;\\n\\nclass OpenAiRequest<\\n  Input extends InputType = InputType,\\n  Output extends OutputType = OutputType,\\n> extends AbstractXRequestClass<Input, Output> {\\n  client: any;\\n  stream: OpenAI | undefined;\\n\\n  _isTimeout = false;\\n  _isStreamTimeout = false;\\n  _isRequesting = false;\\n\\n  constructor(baseURL: string, options: XRequestOptions<Input, Output>) {\\n    super(baseURL, options);\\n    this.client = new OpenAI({\\n      apiKey: 'OPENAI_API_KEY',\\n      dangerouslyAllowBrowser: true,\\n    });\\n  }\\n  get asyncHandler(): Promise<any> {\\n    return Promise.resolve();\\n  }\\n  get isTimeout(): boolean {\\n    return this._isTimeout;\\n  }\\n  get isStreamTimeout(): boolean {\\n    return this._isStreamTimeout;\\n  }\\n  get isRequesting(): boolean {\\n    return this._isRequesting;\\n  }\\n  get manual(): boolean {\\n    return true;\\n  }\\n  async run(input: Input): Promise<void> {\\n    const { callbacks } = this.options;\\n    try {\\n      await this.client.responses.create({\\n        model: 'gpt-4o',\\n        input: input?.messages?.[0]?.content || '',\\n        stream: true,\\n      });\\n\\n      // 请基于 response 实现 流数据更新逻辑\\n      // Please implement stream data update logic based on response\\n    } catch (error: any) {\\n      callbacks?.onError(error);\\n    }\\n  }\\n  abort(): void {\\n    // 请基于openai 实现 abort\\n    // Please implement abort based on OpenAI\\n  }\\n}\\n\\nconst provider = new OpenAIChatProvider<XModelMessage, InputType, OutputType>({\\n  request: new OpenAiRequest('OPENAI', {}),\\n});\\n\\nconst Demo: React.FC = () => {\\n  const [content, setContent] = useState('');\\n  const { onRequest, messages, requesting, abort } = useXChat({\\n    provider,\\n    requestPlaceholder: () => {\\n      return {\\n        content: 'loading...',\\n        role: 'assistant',\\n      };\\n    },\\n    requestFallback: (_, { error }) => {\\n      if (error.name === 'AbortError') {\\n        return {\\n          content: 'Request is aborted',\\n          role: 'assistant',\\n        };\\n      }\\n      return {\\n        content: error?.toString(),\\n        role: 'assistant',\\n      };\\n    },\\n  });\\n\\n  const items = messages.map(({ message, id }) => ({\\n    key: id,\\n    ...message,\\n  }));\\n\\n  const role: BubbleListProps['role'] = {\\n    assistant: {\\n      placement: 'start',\\n    },\\n    user: { placement: 'end' },\\n  };\\n\\n  return (\\n    <Flex\\n      vertical\\n      justify=\\\"space-between\\\"\\n      style={{\\n        height: 400,\\n        padding: 16,\\n      }}\\n    >\\n      <Bubble.List role={role} items={items} />\\n      <Sender\\n        value={content}\\n        onChange={setContent}\\n        loading={requesting}\\n        onCancel={abort}\\n        onSubmit={(val) => {\\n          onRequest({\\n            messages: [{ role: 'user', content: val }],\\n          });\\n          setContent('');\\n        }}\\n      />\\n    </Flex>\\n  );\\n};\\n\\nexport default Demo;\\n\",\"paraId\":6,\"tocIndex\":3}];\n  "],"names":[],"mappings":"6PAEe,6CAAA,QADN,YACA,IAAM,EAAQ,CAAC,CAAC,MAAQ,+NAA0D,OAAS,CAAC,EAAE,CAAC,MAAQ,QAAQ,OAAS,CAAC,EAAE,CAAC,MAAQ,SAAI,OAAS,CAAC,EAAE,CAAC,MAAQ,oIAAgC,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,QAAQ,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,SAAI,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,uKAA+C,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,0BAA0B,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,SAAI,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,iBAAO,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,0BAA0B,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,6HAAmC,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,eAAK,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,SAAI,OAAS,EAAE,SAAW,CAAC,EAAE,CAAC,MAAQ,8zGAAyuG,OAAS,EAAE,SAAW,CAAC,EAAE"}